<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRB 2.0 Documentation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .main-header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-bottom: 1px solid #334155;
            padding: 24px 32px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .logo h1 {
            font-size: 24px;
            font-weight: 700;
        }
        .logo span {
            background: #10b981;
            color: #fff;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 4px;
            background: #0f172a;
            padding: 4px;
            border-radius: 10px;
        }
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: #94a3b8;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .tab-btn:hover {
            background: #334155;
            color: #fff;
        }
        .tab-btn.active {
            background: #3b82f6;
            color: #fff;
        }
        .tab-btn .icon {
            font-size: 16px;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            padding: 32px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .tab-content.active {
            display: block;
        }

        /* ==================== SHARED STYLES ==================== */
        section {
            background: #1e293b;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 32px;
        }
        h2 {
            font-size: 20px;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #334155;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            font-size: 16px;
            color: #94a3b8;
            margin: 24px 0 12px 0;
        }
        h4 {
            font-size: 14px;
            color: #64748b;
            margin: 16px 0 8px 0;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin: 16px 0;
        }
        th {
            text-align: left;
            padding: 12px;
            background: #0f172a;
            color: #94a3b8;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #334155;
        }
        tr:hover td { background: rgba(59, 130, 246, 0.1); }

        /* Code */
        code {
            font-family: 'SF Mono', Monaco, monospace;
            background: #334155;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }
        pre {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            line-height: 1.5;
            margin: 12px 0;
        }
        pre code { background: none; padding: 0; }
        .keyword { color: #c084fc; }
        .type { color: #22d3ee; }
        .string { color: #86efac; }
        .number { color: #fbbf24; }
        .comment { color: #64748b; }
        .property { color: #60a5fa; }

        /* Notes */
        .note {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            font-size: 14px;
        }
        .note-title {
            color: #60a5fa;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 13px;
        }
        .warning {
            background: rgba(251, 191, 36, 0.1);
            border-color: rgba(251, 191, 36, 0.3);
        }
        .warning .note-title { color: #fbbf24; }

        /* Grid */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
        }
        @media (max-width: 900px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .header-content { flex-direction: column; }
            .tab-nav { width: 100%; justify-content: center; flex-wrap: wrap; }
        }

        /* ==================== ARCHITECTURE TAB ==================== */
        .diagram-section {
            background: #1e293b;
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }
        .diagram-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        .badge-threshold { background: #0891b2; color: #fff; }
        .badge-direct { background: #8b5cf6; color: #fff; }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
        }
        .footer-card {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
        }
        .footer-card h3 {
            color: #94a3b8;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }
        .footer-card ul {
            list-style: none;
            font-size: 13px;
        }
        .footer-card li {
            margin-bottom: 6px;
            padding-left: 16px;
            position: relative;
        }
        .footer-card li::before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #64748b;
        }

        /* ==================== SPEC TAB ==================== */
        .method {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }
        .method-get { background: #10b981; color: #fff; }
        .method-post { background: #3b82f6; color: #fff; }
        .method-put { background: #f59e0b; color: #fff; }
        .method-delete { background: #ef4444; color: #fff; }

        .endpoint {
            background: #0f172a;
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            border-left: 4px solid #3b82f6;
        }
        .endpoint-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .endpoint-path {
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 15px;
            color: #e2e8f0;
        }
        .endpoint-desc {
            color: #94a3b8;
            font-size: 14px;
            margin-bottom: 16px;
        }
        .required { color: #f87171; font-size: 11px; font-weight: 600; }
        .optional { color: #64748b; font-size: 11px; }
        .field-type { color: #22d3ee; font-family: monospace; font-size: 12px; }

        .status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }
        .status-pending { background: #fbbf24; color: #000; }
        .status-inuse { background: #3b82f6; color: #fff; }
        .status-completed { background: #10b981; color: #fff; }
        .status-expired { background: #6b7280; color: #fff; }

        .pubsub-channel {
            background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
            border-radius: 8px;
            padding: 16px;
            margin: 12px 0;
        }
        .channel-name {
            font-family: monospace;
            font-size: 14px;
            color: #fca5a5;
            margin-bottom: 8px;
        }

        /* Spec Sub Navigation */
        .spec-nav-link {
            color: #94a3b8;
            text-decoration: none;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 13px;
            transition: all 0.2s;
            display: inline-block;
            border: 1px solid transparent;
        }
        .spec-nav-link:hover {
            background: #334155;
            color: #fff;
            border-color: #475569;
        }
        .spec-nav-link.active {
            background: #3b82f6;
            color: #fff;
        }

        /* ==================== Q&A TAB ==================== */
        .decisions {
            background: linear-gradient(135deg, #14532d 0%, #166534 100%);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }
        .decisions h2 {
            color: #86efac;
            font-size: 16px;
            margin-bottom: 16px;
            border: none;
            padding: 0;
        }
        .decision-list {
            list-style: none;
        }
        .decision-list li {
            padding: 12px 0;
            border-bottom: 1px solid rgba(134, 239, 172, 0.2);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .decision-list li:last-child { border-bottom: none; }
        .decision-number {
            background: #22c55e;
            color: #052e16;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .qa-card {
            background: #1e293b;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .question {
            background: #334155;
            padding: 20px 24px;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .q-badge {
            background: #f59e0b;
            color: #000;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            flex-shrink: 0;
        }
        .answer {
            padding: 24px;
        }
        .answer-label {
            color: #10b981;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .solutions { margin-top: 16px; }
        .solution {
            background: #0f172a;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #3b82f6;
        }
        .solution.recommended {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        .solution-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .solution-title { font-weight: 600; font-size: 14px; }
        .badge-recommended { background: #10b981; color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 10px; }
        .badge-alternative { background: #6b7280; color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 10px; }
        .solution p { color: #94a3b8; font-size: 13px; }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 16px 0;
        }
        .comparison-box {
            background: #0f172a;
            border-radius: 8px;
            padding: 16px;
        }
        .comparison-box h4 { font-size: 13px; margin-bottom: 12px; color: #94a3b8; }
        .comparison-box.before { border-top: 3px solid #ef4444; }
        .comparison-box.after { border-top: 3px solid #10b981; }

        /* Footer */
        .main-footer {
            text-align: center;
            padding: 40px;
            color: #64748b;
            font-size: 13px;
            border-top: 1px solid #334155;
        }
    </style>
</head>
<body>
    <!-- Header with Tab Navigation -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo">
                <h1>FRB 2.0</h1>
                <span>Documentation</span>
            </div>
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="architecture">
                    <span class="icon">ğŸ“</span> Architecture
                </button>
                <button class="tab-btn" data-tab="spec">
                    <span class="icon">ğŸ“‹</span> API & Schema
                </button>
                <button class="tab-btn" data-tab="qa">
                    <span class="icon">ğŸ’¬</span> Q&A
                </button>
            </nav>
        </div>
    </header>

    <!-- ==================== ARCHITECTURE TAB ==================== -->
    <div id="architecture" class="tab-content active">
        <div style="text-align: center; margin-bottom: 32px;">
            <h2 style="border: none; display: block; font-size: 24px;">System Architecture</h2>
            <p style="color: #94a3b8;">Free Round Bonus - å¤šå±¤ç´šéšæ¢¯é–€æª»ç³»çµ±</p>
        </div>

        <!-- Flow A: Threshold Mode -->
        <div class="diagram-section">
            <div class="diagram-title">
                <span class="badge badge-threshold">Flow A</span>
                é–€æª»æ¨¡å¼ - ç©å®¶ä¸‹æ³¨é”æ¨™è‡ªå‹•ç™¼åˆ¸
            </div>
            <svg viewBox="0 0 1100 300" style="width: 100%; height: auto;">
                <defs>
                    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#64748b"/>
                    </marker>
                    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#f87171"/>
                    </marker>
                    <marker id="arrow-orange" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#ea580c"/>
                    </marker>
                </defs>

                <!-- Row 1: CDC Flow (OceanBase -> Kafka -> Aggregator) -->
                <!-- OceanBase CDC Source -->
                <rect x="20" y="25" width="100" height="45" fill="#0f766e"/>
                <ellipse cx="70" cy="70" rx="50" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <ellipse cx="70" cy="25" rx="50" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <text x="70" y="50" text-anchor="middle" fill="#fff" font-size="10" font-weight="600">OceanBase</text>
                <text x="70" y="95" text-anchor="middle" fill="#2dd4bf" font-size="8">(Bet Records)</text>

                <!-- Kafka -->
                <rect x="180" y="35" width="80" height="40" rx="6" fill="#ea580c"/>
                <text x="220" y="60" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">Kafka</text>

                <!-- Aggregator -->
                <rect x="320" y="30" width="110" height="50" rx="8" fill="#0891b2"/>
                <text x="375" y="52" text-anchor="middle" fill="#fff" font-size="12" font-weight="600">Aggregator</text>
                <text x="375" y="68" text-anchor="middle" fill="#a5f3fc" font-size="9">Consume & ç´¯è¨ˆ</text>

                <!-- CDC Arrows -->
                <path d="M 120 50 L 180 55" stroke="#ea580c" stroke-width="2" marker-end="url(#arrow-orange)"/>
                <text x="150" y="42" text-anchor="middle" fill="#ea580c" font-size="8">CDC</text>
                
                <path d="M 260 55 L 320 55" stroke="#ea580c" stroke-width="2" marker-end="url(#arrow-orange)"/>
                <text x="290" y="48" text-anchor="middle" fill="#94a3b8" font-size="8">â‘¢</text>

                <!-- Row 2: Main Flow -->
                <!-- Back Office -->
                <rect x="20" y="130" width="120" height="60" rx="8" fill="#7c3aed"/>
                <text x="80" y="157" text-anchor="middle" fill="#fff" font-size="13" font-weight="600">Back Office</text>
                <text x="80" y="175" text-anchor="middle" fill="#c4b5fd" font-size="10">æ´»å‹•è¨­å®š UI</text>

                <!-- MySQL -->
                <rect x="175" y="130" width="90" height="45" fill="#0f766e"/>
                <ellipse cx="220" cy="175" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <ellipse cx="220" cy="130" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <text x="220" y="158" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">MySQL</text>

                <!-- FRB Service Box (includes Aggregator + Campaign) -->
                <rect x="310" y="20" width="135" height="180" rx="10" fill="none" stroke="#0891b2" stroke-width="2" stroke-dasharray="6,3"/>
                <text x="377" y="212" text-anchor="middle" fill="#22d3ee" font-size="10" font-weight="600">FRB Service</text>

                <!-- Campaign -->
                <rect x="320" y="130" width="110" height="55" rx="8" fill="#0891b2"/>
                <text x="375" y="155" text-anchor="middle" fill="#fff" font-size="12" font-weight="600">Campaign</text>
                <text x="375" y="172" text-anchor="middle" fill="#a5f3fc" font-size="9">é–€æª»æª¢æŸ¥ & ç™¼ç¥¨</text>

                <!-- Aggregator to Campaign arrow -->
                <path d="M 375 80 L 375 130" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>

                <!-- OceanBase (Tickets) -->
                <rect x="475" y="130" width="90" height="45" fill="#0f766e"/>
                <ellipse cx="520" cy="175" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <ellipse cx="520" cy="130" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <text x="520" y="158" text-anchor="middle" fill="#fff" font-size="10" font-weight="600">OceanBase</text>

                <!-- Redis -->
                <rect x="610" y="125" width="100" height="50" fill="#dc2626"/>
                <ellipse cx="660" cy="175" rx="50" ry="18" fill="#dc2626" stroke="#f87171" stroke-width="2"/>
                <ellipse cx="660" cy="125" rx="50" ry="18" fill="#dc2626" stroke="#f87171" stroke-width="2"/>
                <text x="660" y="148" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">Redis</text>
                <text x="660" y="163" text-anchor="middle" fill="#fca5a5" font-size="9">Pub/Sub</text>

                <!-- GameServer -->
                <rect x="780" y="125" width="130" height="55" rx="8" fill="#c2410c"/>
                <text x="845" y="150" text-anchor="middle" fill="#fff" font-size="13" font-weight="600">GameServer</text>
                <text x="845" y="168" text-anchor="middle" fill="#fed7aa" font-size="10">åŸ·è¡Œ Free Round</text>

                <!-- Game Client -->
                <rect x="970" y="125" width="110" height="55" rx="8" fill="#9a3412"/>
                <text x="1025" y="150" text-anchor="middle" fill="#fff" font-size="12" font-weight="600">Game Client</text>
                <text x="1025" y="168" text-anchor="middle" fill="#fed7aa" font-size="9">UI é¡¯ç¤º</text>

                <!-- Ticket Status Legend -->
                <rect x="850" y="25" width="230" height="85" rx="8" fill="#1e293b" stroke="#334155" stroke-width="1"/>
                <text x="965" y="45" text-anchor="middle" fill="#94a3b8" font-size="10" font-weight="600">Ticket Status</text>
                <text x="870" y="65" fill="#fbbf24" font-size="9">â— pending</text>
                <text x="980" y="65" fill="#3b82f6" font-size="9">â— inuse</text>
                <text x="870" y="82" fill="#10b981" font-size="9">â— completed</text>
                <text x="980" y="82" fill="#6b7280" font-size="9">â— expired</text>
                <text x="870" y="99" fill="#f472b6" font-size="9">â— early_completed</text>

                <!-- Main Flow Arrows -->
                <path d="M 140 160 L 175 160" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="157" y="152" text-anchor="middle" fill="#94a3b8" font-size="8">â‘ </text>

                <path d="M 265 155 L 320 155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="4"/>
                <text x="292" y="148" text-anchor="middle" fill="#94a3b8" font-size="8">â‘¡</text>

                <path d="M 430 155 L 475 155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="452" y="148" text-anchor="middle" fill="#94a3b8" font-size="8">â‘£</text>

                <path d="M 430 165 L 610 165" stroke="#f87171" stroke-width="2" marker-end="url(#arrow-red)"/>
                <text x="520" y="185" text-anchor="middle" fill="#fca5a5" font-size="9">â‘¤ PUBLISH ticket:created</text>

                <path d="M 710 150 L 780 150" stroke="#f87171" stroke-width="2" marker-end="url(#arrow-red)"/>
                <text x="745" y="143" text-anchor="middle" fill="#fca5a5" font-size="8">â‘¥</text>

                <path d="M 910 152 L 970 152" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
                <text x="940" y="145" text-anchor="middle" fill="#94a3b8" font-size="8">â‘¦</text>

                <!-- GameServer -> OceanBase (Update ticket status) - route below -->
                <path d="M 845 180 L 845 205 L 520 205 L 520 190" stroke="#10b981" stroke-width="2" marker-end="url(#arrow)" fill="none"/>
                <text x="700" y="220" text-anchor="middle" fill="#86efac" font-size="9">â‘§ UPDATE ticket status</text>

                <!-- Step descriptions -->
                <text x="20" y="245" fill="#94a3b8" font-size="10">
                    <tspan>â‘  å»ºç«‹æ´»å‹•/å±¤ç´š</tspan>
                    <tspan x="20" dy="14">â‘¡ è®€å–é–€æª»è¨­å®š</tspan>
                    <tspan x="20" dy="14">â‘¢ OceanBase CDC â†’ Kafka â†’ Aggregator</tspan>
                </text>
                <text x="350" y="245" fill="#94a3b8" font-size="10">
                    <tspan>â‘£ å¯«å…¥ç¥¨åˆ¸è¨˜éŒ„</tspan>
                    <tspan x="350" dy="14">â‘¤ ç™¼å¸ƒ ticket:created</tspan>
                    <tspan x="350" dy="14">â‘¥ è¨‚é–±ä¸¦æ¥æ”¶ç¥¨åˆ¸</tspan>
                </text>
                <text x="620" y="245" fill="#94a3b8" font-size="10">
                    <tspan>â‘¦ åŸ·è¡Œ Free Round</tspan>
                    <tspan x="620" dy="14">â‘§ æ›´æ–° OceanBase ticket status</tspan>
                </text>
            </svg>
        </div>

        <!-- Flow B: Direct API Mode -->
        <div class="diagram-section">
            <div class="diagram-title">
                <span class="badge badge-direct">Flow B</span>
                ç›´æ¥é€åˆ¸æ¨¡å¼ - Operator é€é API é€åˆ¸çµ¦ç‰¹å®šç©å®¶
            </div>
            <svg viewBox="0 0 1100 200" style="width: 100%; height: auto;">
                <defs>
                    <marker id="arrow2" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#64748b"/>
                    </marker>
                    <marker id="arrow2-purple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#a78bfa"/>
                    </marker>
                    <marker id="arrow2-red" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#f87171"/>
                    </marker>
                </defs>

                <rect x="20" y="50" width="120" height="70" rx="8" fill="#7c3aed"/>
                <text x="80" y="80" text-anchor="middle" fill="#fff" font-size="13" font-weight="600">Operator</text>
                <text x="80" y="100" text-anchor="middle" fill="#c4b5fd" font-size="10">å¾Œå° / CRM</text>

                <rect x="200" y="50" width="130" height="70" rx="8" fill="#6366f1"/>
                <text x="265" y="80" text-anchor="middle" fill="#fff" font-size="13" font-weight="600">Platform API</text>
                <text x="265" y="100" text-anchor="middle" fill="#c7d2fe" font-size="10">å…¥å£ Gateway</text>

                <!-- FRB Service Box with dashed border -->
                <rect x="365" y="35" width="140" height="100" rx="10" fill="none" stroke="#0891b2" stroke-width="2" stroke-dasharray="6,3"/>
                <text x="435" y="145" text-anchor="middle" fill="#22d3ee" font-size="10" font-weight="600">FRB Service</text>

                <!-- FRB Service inner component -->
                <rect x="375" y="50" width="120" height="55" rx="8" fill="#0891b2"/>
                <text x="435" y="75" text-anchor="middle" fill="#fff" font-size="12" font-weight="600">Campaign</text>
                <text x="435" y="92" text-anchor="middle" fill="#a5f3fc" font-size="9">ç›´æ¥ç™¼ç¥¨ (ç„¡é–€æª»)</text>

                <!-- OceanBase -->
                <rect x="540" y="45" width="90" height="45" fill="#0f766e"/>
                <ellipse cx="585" cy="90" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <ellipse cx="585" cy="45" rx="45" ry="15" fill="#0f766e" stroke="#2dd4bf" stroke-width="2"/>
                <text x="585" y="72" text-anchor="middle" fill="#fff" font-size="10" font-weight="600">OceanBase</text>

                <!-- Redis -->
                <rect x="665" y="45" width="90" height="45" fill="#dc2626"/>
                <ellipse cx="710" cy="90" rx="45" ry="15" fill="#dc2626" stroke="#f87171" stroke-width="2"/>
                <ellipse cx="710" cy="45" rx="45" ry="15" fill="#dc2626" stroke="#f87171" stroke-width="2"/>
                <text x="710" y="65" text-anchor="middle" fill="#fff" font-size="10" font-weight="600">Redis</text>
                <text x="710" y="80" text-anchor="middle" fill="#fca5a5" font-size="8">Pub/Sub</text>

                <rect x="790" y="42" width="120" height="60" rx="8" fill="#c2410c"/>
                <text x="850" y="68" text-anchor="middle" fill="#fff" font-size="12" font-weight="600">GameServer</text>
                <text x="850" y="85" text-anchor="middle" fill="#fed7aa" font-size="9">åŸ·è¡Œ Free Round</text>

                <rect x="945" y="42" width="100" height="60" rx="8" fill="#9a3412"/>
                <text x="995" y="68" text-anchor="middle" fill="#fff" font-size="11" font-weight="600">Game Client</text>
                <text x="995" y="85" text-anchor="middle" fill="#fed7aa" font-size="8">UI é¡¯ç¤º</text>

                <path d="M 140 85 L 200 85" stroke="#a78bfa" stroke-width="2" marker-end="url(#arrow2-purple)"/>
                <text x="170" y="75" text-anchor="middle" fill="#a78bfa" font-size="9">â‘ </text>

                <path d="M 330 85 L 375 77" stroke="#a78bfa" stroke-width="2" marker-end="url(#arrow2-purple)"/>
                <text x="352" y="72" text-anchor="middle" fill="#a78bfa" font-size="9">â‘¡</text>

                <!-- Campaign -> OceanBase -->
                <path d="M 495 70 L 540 70" stroke="#64748b" stroke-width="2" marker-end="url(#arrow2)"/>
                <text x="517" y="62" text-anchor="middle" fill="#94a3b8" font-size="9">â‘¢</text>

                <!-- Campaign -> Redis (PUBLISH) -->
                <path d="M 495 85 L 665 85" stroke="#f87171" stroke-width="2" marker-end="url(#arrow2-red)"/>
                <text x="580" y="110" text-anchor="middle" fill="#fca5a5" font-size="8">â‘£ PUBLISH ticket:created</text>

                <path d="M 755 70 L 790 70" stroke="#f87171" stroke-width="2" marker-end="url(#arrow2-red)"/>
                <text x="772" y="62" text-anchor="middle" fill="#fca5a5" font-size="9">â‘¤</text>

                <path d="M 910 72 L 945 72" stroke="#64748b" stroke-width="2" marker-end="url(#arrow2)"/>
                <text x="927" y="64" text-anchor="middle" fill="#94a3b8" font-size="9">â‘¥</text>

                <!-- GameServer -> OceanBase (UPDATE status) -->
                <path d="M 850 102 L 850 125 L 585 125 L 585 105" stroke="#10b981" stroke-width="2" marker-end="url(#arrow2)" fill="none"/>
                <text x="717" y="140" text-anchor="middle" fill="#86efac" font-size="8">â‘¦ UPDATE ticket status</text>

                <text x="20" y="155" fill="#94a3b8" font-size="10">
                    <tspan font-weight="600" fill="#a78bfa">API Endpoints:</tspan>
                    <tspan x="20" dy="16">POST /api/frb/tickets - å–®å¼µç™¼åˆ¸</tspan>
                    <tspan x="20" dy="14">POST /api/frb/tickets/batch - æ‰¹é‡ç™¼åˆ¸</tspan>
                </text>
                <text x="280" y="155" fill="#94a3b8" font-size="10">
                    <tspan>â‘  Operator å‘¼å« API</tspan>
                    <tspan x="280" dy="14">â‘¡ Platform API è½‰ç™¼è‡³ FRB Service</tspan>
                    <tspan x="280" dy="14">â‘¢ å¯«å…¥ OceanBase ç¥¨åˆ¸è¨˜éŒ„</tspan>
                </text>
                <text x="560" y="155" fill="#94a3b8" font-size="10">
                    <tspan>â‘£ PUBLISH ticket:created</tspan>
                    <tspan x="560" dy="14">â‘¤ GameServer æ”¶åˆ°ç¥¨åˆ¸é€šçŸ¥</tspan>
                    <tspan x="560" dy="14">â‘¥ åŸ·è¡Œ Free Round / â‘¦ UPDATE status</tspan>
                </text>
            </svg>
        </div>

        <!-- Comparison Table -->
        <div class="diagram-section">
            <div class="diagram-title">å…©ç¨®æ¨¡å¼æ¯”è¼ƒ</div>
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th style="color: #22d3ee;">Flow A: é–€æª»æ¨¡å¼</th>
                        <th style="color: #a78bfa;">Flow B: ç›´æ¥é€åˆ¸</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="color: #94a3b8;">è§¸ç™¼æ–¹å¼</td>
                        <td>ç©å®¶ä¸‹æ³¨ç´¯è¨ˆé”é–€æª»</td>
                        <td>Operator ä¸»å‹•å‘¼å« API</td>
                    </tr>
                    <tr>
                        <td style="color: #94a3b8;">ä½¿ç”¨å ´æ™¯</td>
                        <td>å¸¸æ…‹æ´»å‹•ã€å¤šå±¤ç´šçå‹µ</td>
                        <td>VIP è£œå„Ÿã€è¡ŒéŠ·æ´»å‹•ã€ç‰¹å®šç©å®¶å›é¥‹</td>
                    </tr>
                    <tr>
                        <td style="color: #94a3b8;">å…¥å£</td>
                        <td>GameServer CDC â†’ Aggregator</td>
                        <td>Platform API Gateway</td>
                    </tr>
                    <tr>
                        <td style="color: #94a3b8;">é–€æª»æª¢æŸ¥</td>
                        <td>âœ“ æª¢æŸ¥ threshold / level / limit</td>
                        <td>âœ— è·³é (ç›´æ¥ç™¼åˆ¸)</td>
                    </tr>
                    <tr>
                        <td style="color: #94a3b8;">å¾ŒçºŒæµç¨‹</td>
                        <td colspan="2">ç›¸åŒï¼šRedis Pub/Sub â†’ GameServer â†’ Game Client</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Footer Info -->
        <div class="footer-grid">
            <div class="footer-card">
                <h3>Redis Pub/Sub Channels</h3>
                <ul style="color: #fca5a5; font-family: monospace;">
                    <li>frb:ticket:created</li>
                    <li>frb:ticket:expiring</li>
                    <li>frb:ticket:completed</li>
                </ul>
            </div>
            <div class="footer-card">
                <h3>Cap è¨ˆç®—å…¬å¼</h3>
                <ul>
                    <li style="font-family: monospace; color: #fef3c7;">actual = min(raw_win, max(0, cap - accumulated))</li>
                    <li>æ¯æ¬¡ Spin å³æ™‚å¥—ç”¨</li>
                    <li>ä½¿ç”¨ cents æ•´æ•¸é‹ç®—</li>
                </ul>
            </div>
            <div class="footer-card">
                <h3>Ticket ç‹€æ…‹æµ</h3>
                <ul>
                    <li style="font-family: monospace;">pending â†’ inuse â†’ completed</li>
                    <li style="font-family: monospace;">pending â†’ expired</li>
                    <li style="font-family: monospace;">inuse â†’ expiring â†’ expired</li>
                </ul>
            </div>
        </div>

        <!-- Important Notes -->
        <div style="background: linear-gradient(135deg, #1e3a5f 0%, #1e293b 100%); border: 1px solid #3b82f6; border-radius: 12px; padding: 24px; margin-top: 32px;">
            <h3 style="color: #60a5fa; margin-bottom: 16px; font-size: 16px;">ğŸ“Œ é‡è¦è¨­è¨ˆèªªæ˜</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                
                <!-- Note 1: Currency-based settings -->
                <div style="background: rgba(0,0,0,0.2); padding: 16px; border-radius: 8px; border-left: 3px solid #fbbf24;">
                    <h4 style="color: #fbbf24; font-size: 13px; margin-bottom: 8px;">ğŸ’° å¹£åˆ¥è¨­å®š</h4>
                    <p style="color: #cbd5e1; font-size: 13px; line-height: 1.6;">
                        FRB çš„<strong style="color: #fde68a;">æµæ°´ç´¯ç©é–€æª»</strong>èˆ‡<strong style="color: #fde68a;">Max Payout</strong> éƒ½éœ€è¦ <strong style="color: #fde68a;">by å¹£åˆ¥</strong>è¨­å®šã€‚
                        ä¸åŒå¹£åˆ¥çš„é–€æª»èˆ‡ä¸Šé™å¯èƒ½ä¸åŒã€‚
                    </p>
                </div>

                <!-- Note 2: Campaign API -->
                <div style="background: rgba(0,0,0,0.2); padding: 16px; border-radius: 8px; border-left: 3px solid #22d3ee;">
                    <h4 style="color: #22d3ee; font-size: 13px; margin-bottom: 8px;">ğŸ”§ Campaign API</h4>
                    <p style="color: #cbd5e1; font-size: 13px; line-height: 1.6;">
                        Campaign API å¯ä»¥<strong style="color: #a5f3fc;">ç›´æ¥ create campaign</strong>ï¼Œä¸éœ€è¦é€é Back Office UIã€‚
                        æ”¯æ´ç¨‹å¼åŒ–å»ºç«‹æ´»å‹•ã€‚
                    </p>
                </div>

                <!-- Note 3: Platform API Verification -->
                <div style="background: rgba(0,0,0,0.2); padding: 16px; border-radius: 8px; border-left: 3px solid #f472b6;">
                    <h4 style="color: #f472b6; font-size: 13px; margin-bottom: 8px;">ğŸ” Platform API é©—è­‰æ©Ÿåˆ¶</h4>
                    <ul style="color: #cbd5e1; font-size: 13px; line-height: 1.8; padding-left: 16px; margin: 0;">
                        <li><strong style="color: #fbcfe8;">Operator é©—è­‰</strong>ï¼šé©—è­‰æˆ³æ¥å£çš„ operator æ˜¯å¦ç‚ºå»ºç«‹è©²æ´»å‹•çš„ operator</li>
                        <li><strong style="color: #fbcfe8;">é©—è­‰ä½ç½®</strong>ï¼šåœ¨ Platform API å±¤é€²è¡Œé©—è­‰</li>
                        <li><strong style="color: #fbcfe8;">IP ç™½åå–®</strong>ï¼šæ²¿ç”¨ç¾æœ‰ Platform API çš„ operator IP é©—è­‰æ©Ÿåˆ¶</li>
                    </ul>
                </div>

            </div>
        </div>
    </div>

    <!-- ==================== SPEC TAB ==================== -->
    <div id="spec" class="tab-content">
        <div style="text-align: center; margin-bottom: 32px;">
            <h2 style="border: none; display: block; font-size: 24px;">API & Database Schema</h2>
            <p style="color: #94a3b8;">Technical Specification for Development</p>
            <span style="display: inline-block; background: #10b981; color: #fff; padding: 4px 12px; border-radius: 20px; font-size: 12px; margin-top: 12px;">Version 2.0 | 2026-01-13</span>
        </div>

        <!-- Sub Navigation for Spec -->
        <nav style="background: #1e293b; padding: 12px; border-radius: 10px; margin-bottom: 32px; position: sticky; top: 80px; z-index: 50;">
            <ul style="display: flex; justify-content: center; gap: 8px; list-style: none; flex-wrap: wrap;">
                <li><a href="#spec-overview" class="spec-nav-link">Overview</a></li>
                <li><a href="#spec-platform-api" class="spec-nav-link">Platform API</a></li>
                <li><a href="#spec-frb-api" class="spec-nav-link">FRB Service API</a></li>
                <li><a href="#spec-backoffice-api" class="spec-nav-link">Back Office API</a></li>
                <li><a href="#spec-mysql" class="spec-nav-link">MySQL Schema</a></li>
                <li><a href="#spec-oceanbase" class="spec-nav-link">OceanBase Schema</a></li>
                <li><a href="#spec-redis" class="spec-nav-link">Redis Structure</a></li>
                <li><a href="#spec-pubsub" class="spec-nav-link">Pub/Sub Events</a></li>
            </ul>
        </nav>

        <!-- Overview -->
        <section id="spec-overview">
            <h2>ğŸ“‹ Overview</h2>
            <div class="grid-2">
                <div>
                    <h3>å…©ç¨®ç™¼åˆ¸æ¨¡å¼</h3>
                    <table>
                        <tr><td><strong>Flow A: é–€æª»æ¨¡å¼</strong></td><td>ç©å®¶ä¸‹æ³¨é”æ¨™ â†’ è‡ªå‹•ç™¼åˆ¸</td></tr>
                        <tr><td><strong>Flow B: ç›´æ¥é€åˆ¸</strong></td><td>Operator API å‘¼å« â†’ æŒ‡å®šç©å®¶ç™¼åˆ¸</td></tr>
                    </table>
                </div>
                <div>
                    <h3>Ticket ç‹€æ…‹</h3>
                    <table>
                        <tr><td><span class="status status-pending">pending</span></td><td>å·²ç™¼åˆ¸ï¼Œç­‰å¾…ä½¿ç”¨</td></tr>
                        <tr><td><span class="status status-inuse">inuse</span></td><td>æ­£åœ¨ä½¿ç”¨ä¸­</td></tr>
                        <tr><td><span class="status status-completed">completed</span></td><td>å·²å®Œæˆï¼ˆç”¨å®Œæ‰€æœ‰ Roundsï¼‰</td></tr>
                        <tr><td><span class="status" style="background: #db2777; color: #fce7f3;">early_completed</span></td><td>æå‰çµæŸï¼ˆé”åˆ° Max Payoutï¼‰</td></tr>
                        <tr><td><span class="status status-expired">expired</span></td><td>å·²éæœŸ</td></tr>
                    </table>
                </div>
            </div>
        </section>

        <!-- Platform API -->
        <section id="spec-platform-api">
            <h2>ğŸŒ PlatformApi - FRB API</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Base URL: <code>/frb</code> | PlatformApi æä¾›çµ¦ Operator çš„ FRB ç¥¨åˆ¸ç®¡ç†æ¥å£</p>

            <div class="note">
                <div class="note-title">ğŸ” é©—è­‰æ©Ÿåˆ¶</div>
                <ul style="margin-left: 20px; color: #94a3b8;">
                    <li><strong>Header é©—è­‰</strong>: éœ€æä¾› <code>X-Operator-Id</code></li>
                    <li><strong>IP ç™½åå–®</strong>: ç³»çµ±æœƒé©—è­‰ä¾†æº IP æ˜¯å¦åœ¨ Operator çš„ç™½åå–®ä¸­</li>
                    <li><strong>Type</strong>: <code>IpWhiteTypeEnum.Funds</code></li>
                </ul>
            </div>

            <!-- FRB Create Ticket -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/frb/tickets</span>
                </div>
                <p class="endpoint-desc">å»ºç«‹ FRB ç¥¨åˆ¸ (Flow B: ç›´æ¥é€åˆ¸) - Operator å‘¼å«æ­¤æ¥å£ç™¼æ”¾ç¥¨åˆ¸çµ¦æŒ‡å®šç©å®¶</p>
                
                <h4>Request Headers</h4>
                <table style="margin: 12px 0;">
                    <tr><th>Header</th><th>é¡å‹</th><th>å¿…å¡«</th><th>èªªæ˜</th></tr>
                    <tr>
                        <td><code>X-Operator-Id</code></td>
                        <td>string</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>ç‡Ÿé‹å•† IDï¼Œç”¨æ–¼é©—è­‰èˆ‡ IP ç™½åå–®æª¢æŸ¥</td>
                    </tr>
                </table>

                <h4>Request Body: <code>ReqCreateTicket</code></h4>
<pre><code>{
  <span class="property">"member_id"</span>: <span class="string">"player_12345"</span>,
  <span class="property">"game_code"</span>: <span class="string">"wild_bounty"</span>,
  <span class="property">"currency"</span>: <span class="string">"USD"</span>,
  <span class="property">"free_rounds"</span>: <span class="number">10</span>,
  <span class="property">"bet_rate_cents"</span>: <span class="number">100</span>,
  <span class="property">"max_payout_cents"</span>: <span class="number">50000</span>,
  <span class="property">"validity_days"</span>: <span class="number">7</span>,
  <span class="property">"reason"</span>: <span class="string">"VIP Compensation"</span>
}</code></pre>

                <h4>Response (201 Created): <code>RespBase&lt;RespCreateTicket&gt;</code></h4>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">0</span>,
  <span class="property">"message"</span>: <span class="string">"Success"</span>,
  <span class="property">"result"</span>: {
    <span class="property">"ticket_id"</span>: <span class="string">"frb_abc123def456"</span>,
    <span class="property">"campaign_id"</span>: <span class="string">"550e8400-e29b-41d4-a716-446655440000"</span>,
    <span class="property">"status"</span>: <span class="string">"pending"</span>,
    <span class="property">"expires_at"</span>: <span class="string">"2026-01-27T00:00:00Z"</span>
  }
}</code></pre>

                <h4>éŒ¯èª¤å›æ‡‰</h4>
                
                <h5>400 Bad Request - X-Operator-Id ç¼ºå¤±</h5>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">9999</span>,
  <span class="property">"message"</span>: <span class="string">"Error"</span>
}</code></pre>

                <h5>403 Forbidden - IP ç™½åå–®é©—è­‰å¤±æ•—</h5>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">1001</span>,  <span class="comment">// ä¾å¯¦éš› ErrorCodeEnum å®šç¾©</span>
  <span class="property">"message"</span>: <span class="string">"IP not in whitelist"</span>
}</code></pre>

                <h5>502 Bad Gateway - FRB Campaign Service éŒ¯èª¤</h5>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">9999</span>,
  <span class="property">"message"</span>: <span class="string">"FRB Campaign service error"</span>
}</code></pre>

                <h5>500 Internal Server Error - ç³»çµ±éŒ¯èª¤</h5>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">9999</span>,
  <span class="property">"message"</span>: <span class="string">"Internal server error"</span>
}</code></pre>

                <h4>è™•ç†æµç¨‹</h4>
                <ol style="color: #94a3b8; padding-left: 20px; font-size: 14px; margin-top: 12px;">
                    <li>é©—è­‰ <code>X-Operator-Id</code> Header æ˜¯å¦å­˜åœ¨</li>
                    <li>æª¢æŸ¥ä¾†æº IP æ˜¯å¦åœ¨ Operator çš„ç™½åå–®ä¸­ (Type: Funds)</li>
                    <li>è½‰ç™¼è«‹æ±‚è‡³ FRB Campaign Service <code>POST /api/tickets</code></li>
                    <li>æ¥æ”¶ Campaign Service å›æ‡‰ä¸¦è¿”å›çµ¦ Operator</li>
                    <li>è¨˜éŒ„æ“ä½œæ—¥èªŒè‡³ AWS</li>
                </ol>

                <div class="note warning" style="margin-top: 16px;">
                    <div class="note-title">âš ï¸ é‡è¦èªªæ˜</div>
                    <ul style="margin-left: 20px; color: #fef3c7;">
                        <li><strong>å¿…é ˆ</strong>åœ¨ Request Header ä¸­æä¾› <code>X-Operator-Id</code></li>
                        <li>ä¾†æº IP <strong>å¿…é ˆ</strong>åœ¨ Operator çš„ IP ç™½åå–®ä¸­</li>
                        <li>PlatformApi æœƒè½‰ç™¼è«‹æ±‚è‡³ FRB Campaign Service</li>
                        <li>æ‰€æœ‰éŒ¯èª¤éƒ½æœƒè¨˜éŒ„è‡³ AWS CloudWatch</li>
                        <li>æˆåŠŸå›æ‡‰ä½¿ç”¨ HTTP 201 Created</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Campaign API -->
        <section id="spec-platform-api-campaign">
            <h2>ğŸŒ PlatformApi V2 - Campaign API</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Base URL: <code>/v2/campaign</code> | è² è²¬è™•ç†èˆ‡ FRB Campaign Service çš„æ•´åˆ</p>

            <!-- 1.1 Get Total Bet Amount -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/v2/campaign/get_total_bet_amount</span>
                </div>
                <p class="endpoint-desc">å–å¾—ç‰¹å®šæœƒå“¡åœ¨ç‰¹å®šæ´»å‹•ä¸­çš„ç¸½ä¸‹æ³¨é‡‘é¡ã€‚æ­¤æ¥å£ä¸²æ¥è‡³ FRB Campaign Serviceã€‚</p>
                
                <h4>Request Body</h4>
<pre><code>{
  <span class="property">"campaign_id"</span>: <span class="string">"string"</span>,
  <span class="property">"operator_id"</span>: <span class="string">"string"</span>,
  <span class="property">"member_id"</span>: <span class="string">"string"</span>
}</code></pre>

                <h4>Response</h4>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">0</span>,
  <span class="property">"message"</span>: <span class="string">"Success"</span>,
  <span class="property">"result"</span>: {
    <span class="property">"campaign_id"</span>: <span class="string">"string"</span>,
    <span class="property">"total_bet_amount"</span>: <span class="number">0.0</span>  <span class="comment">// decimal (é Cent)</span>
  }
}</code></pre>
            </div>

            <!-- 1.2 Get Total Payout -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/v2/campaign/get_total_payout</span>
                </div>
                <p class="endpoint-desc">å–å¾—ç‰¹å®šæ´»å‹•çš„ç¸½æ´¾å½©é‡‘é¡ã€‚æ­¤æ¥å£ä¸²æ¥è‡³ FRB Campaign Serviceã€‚</p>
                
                <h4>Request Body</h4>
<pre><code>{
  <span class="property">"campaign_id"</span>: <span class="string">"string"</span>
}</code></pre>

                <h4>Response</h4>
<pre><code>{
  <span class="property">"code"</span>: <span class="number">0</span>,
  <span class="property">"message"</span>: <span class="string">"Success"</span>,
  <span class="property">"result"</span>: {
    <span class="property">"campaign_id"</span>: <span class="string">"string"</span>,
    <span class="property">"total_payout"</span>: <span class="number">0</span>  <span class="comment">// ulong (cents)</span>
  }
}</code></pre>
            </div>

            <!-- 1.3 Promo Redirect -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/v2/campaign/promo</span>
                </div>
                <p class="endpoint-desc">æ´»å‹•è½‰å€ (302 Redirect è‡³æ´»å‹•é é¢)</p>
                
                <h4>Query Parameters</h4>
                <table style="margin: 12px 0;">
                    <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    <tr><td><code>campaign_id</code></td><td>string</td><td>æ´»å‹•ç·¨è™Ÿ</td></tr>
                    <tr><td><code>operator_id</code></td><td>string</td><td>ç‡Ÿé‹å•†ç·¨è™Ÿ</td></tr>
                    <tr><td><code>member_id</code></td><td>string</td><td>æœƒå“¡ç·¨è™Ÿ</td></tr>
                    <tr><td><code>sign</code></td><td>string</td><td>ç°½ç« é©—è­‰</td></tr>
                </table>

                <h4>Response</h4>
<pre><code><span class="keyword">302</span> <span class="string">Redirect</span> <span class="comment">// è·³è½‰è‡³æ´»å‹• URL</span></code></pre>
            </div>

            <!-- 1.4 Promo Info Redirect -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/v2/campaign/promo_info</span>
                </div>
                <p class="endpoint-desc">æ´»å‹•è³‡è¨Šè½‰å€ (302 Redirect è‡³æ´»å‹•è³‡è¨Šé é¢)</p>
                
                <h4>Query Parameters</h4>
                <p style="color: #94a3b8; font-size: 13px;">åŒ <code>/promo</code> ç«¯é»</p>

                <h4>Response</h4>
<pre><code><span class="keyword">302</span> <span class="string">Redirect</span> <span class="comment">// è·³è½‰è‡³æ´»å‹•è³‡è¨Š URL</span></code></pre>
            </div>

            <!-- Other Campaign APIs -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 24px;">
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method method-post">POST</span>
                        <span class="endpoint-path">/v2/campaign/information_list</span>
                    </div>
                    <p class="endpoint-desc">å–å¾—æ´»å‹•åˆ—è¡¨</p>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method method-post">POST</span>
                        <span class="endpoint-path">/v2/campaign/information_single</span>
                    </div>
                    <p class="endpoint-desc">å–å¾—å–®ä¸€æ´»å‹•è³‡è¨Š</p>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method method-post">POST</span>
                        <span class="endpoint-path">/v2/campaign/message_list</span>
                    </div>
                    <p class="endpoint-desc">å–å¾—è¨Šæ¯åˆ—è¡¨</p>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method method-post">POST</span>
                        <span class="endpoint-path">/v2/campaign/message_single</span>
                    </div>
                    <p class="endpoint-desc">å–å¾—å–®ä¸€è¨Šæ¯</p>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method method-post">POST</span>
                        <span class="endpoint-path">/v2/campaign/read</span>
                    </div>
                    <p class="endpoint-desc">å·²è®€æ´»å‹•è¨Šæ¯</p>
                </div>
            </div>

            <div class="note warning" style="margin-top: 24px;">
                <div class="note-title">âš ï¸ é‡è¦æé†’</div>
                <ul style="margin-left: 20px; color: #fef3c7;">
                    <li>æ‰€æœ‰é‡‘é¡å–®ä½çµ±ä¸€ä½¿ç”¨ <strong>Cent (åˆ†)</strong></li>
                    <li><code>total_bet_amount</code> ç‚º <strong>decimal</strong> é¡å‹ (é Cent)</li>
                    <li><code>promo</code> ç›¸é—œç«¯é»æœƒé€²è¡Œ <strong>302 è·³è½‰</strong></li>
                </ul>
            </div>
        </section>

        <!-- Member API -->
        <section id="spec-platform-api-member">
            <h2>ğŸ‘¤ PlatformApi V2 - Member API</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Base URL: <code>/v2/members</code></p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/v2/members/wallet/refresh</span>
                </div>
                <p class="endpoint-desc">é€šçŸ¥æœƒå“¡éŒ¢åŒ…é¤˜é¡å·²åˆ·æ–°ã€‚æ­¤æ¥å£ä¸²æ¥è‡³ FRB Campaign Serviceï¼Œç”¨æ–¼è§¸ç™¼å³æ™‚é€šçŸ¥ã€‚</p>
                
                <h4>Request Body</h4>
<pre><code>{
  <span class="property">"operator_id"</span>: <span class="string">"string"</span>,
  <span class="property">"member_id"</span>: <span class="string">"string"</span>,
  <span class="property">"balance"</span>: <span class="number">0</span>  <span class="comment">// ulong (cents)</span>
}</code></pre>

                <h4>Response</h4>
<pre><code><span class="keyword">200</span> <span class="string">OK</span></code></pre>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/v1/frb/tickets/{ticket_id}</span>
                </div>
                <p class="endpoint-desc">æŸ¥è©¢å–®å¼µç¥¨åˆ¸è©³ç´°è³‡è¨Š</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/v1/frb/members/{member_id}/tickets</span>
                </div>
                <p class="endpoint-desc">æŸ¥è©¢ç©å®¶æ‰€æœ‰ç¥¨åˆ¸</p>
                <h4>Query Parameters</h4>
                <table>
                    <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    <tr><td><code>status</code></td><td><span class="field-type">string</span></td><td>ç¯©é¸ç‹€æ…‹ <span class="optional">Optional</span></td></tr>
                    <tr><td><code>limit</code></td><td><span class="field-type">int</span></td><td>æ¯é ç­†æ•¸ <span class="optional">Optional</span></td></tr>
                </table>
            </div>
        </section>

        <!-- FRB Service API -->
        <section id="spec-frb-api">
            <h2>âš™ï¸ FRB Campaign Service API (Internal)</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Base URL: <code>/api/tickets</code> | FRB Campaign Service å…§éƒ¨ APIï¼Œä¾› PlatformApi å‘¼å«</p>

            <div class="note">
                <div class="note-title">ğŸ’¡ ä½¿ç”¨æƒ…å¢ƒ</div>
                <p>æ­¤ API ç”¨æ–¼ <strong>Flow B: ç›´æ¥é€åˆ¸</strong> å ´æ™¯ï¼ŒOperator é€é PlatformApi å‘¼å«æ­¤æœå‹™ä¾†ç™¼æ”¾ç¥¨åˆ¸çµ¦æŒ‡å®šç©å®¶ã€‚</p>
            </div>

            <!-- Create Ticket -->
            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/api/tickets</span>
                </div>
                <p class="endpoint-desc">å»ºç«‹ FRB ç¥¨åˆ¸ (Flow B: ç›´æ¥é€åˆ¸)</p>
                
                <h4>Request Body: <code>CreateTicketRequest</code></h4>
<pre><code>{
  <span class="property">"operator"</span>: <span class="string">"OperatorA"</span>,                    <span class="comment">// ç‡Ÿé‹å•†åç¨± (ç”¨æ–¼æŸ¥è©¢ operator.id)</span>
  <span class="property">"member_id"</span>: <span class="string">"player_12345"</span>,                 <span class="comment">// ç©å®¶ ID</span>
  <span class="property">"game"</span>: <span class="string">"WildBounty"</span>,                        <span class="comment">// éŠæˆ²åç¨± (ç”¨æ–¼æŸ¥è©¢ game.id)</span>
  <span class="property">"currency"</span>: <span class="string">"USD"</span>,                           <span class="comment">// å¹£åˆ¥</span>
  <span class="property">"free_rounds"</span>: <span class="number">10</span>,                           <span class="comment">// å…è²»æ—‹è½‰æ¬¡æ•¸</span>
  <span class="property">"bet_rate_cents"</span>: <span class="number">100</span>,                      <span class="comment">// æ¯æ¬¡æ—‹è½‰ä¸‹æ³¨é‡‘é¡ (cents)</span>
  <span class="property">"max_payout_cents"</span>: <span class="number">50000</span>,                  <span class="comment">// æœ€å¤§æ´¾å½©ä¸Šé™ (cents)</span>
  <span class="property">"validity_days"</span>: <span class="number">7</span>,                         <span class="comment">// ç¥¨åˆ¸æœ‰æ•ˆå¤©æ•¸</span>
  <span class="property">"reason"</span>: <span class="string">"VIP Compensation"</span>               <span class="comment">// é€åˆ¸åŸå›  (é¸å¡«)</span>
}</code></pre>

                <h4>Response (200 OK): <code>CreateTicketResponse</code></h4>
<pre><code>{
  <span class="property">"ticket_id"</span>: <span class="string">"frb_abc123def456"</span>,
  <span class="property">"campaign_id"</span>: <span class="string">"550e8400-e29b-41d4-a716-446655440000"</span>,
  <span class="property">"status"</span>: <span class="string">"pending"</span>,
  <span class="property">"expires_at"</span>: <span class="string">"2026-01-27T00:00:00Z"</span>
}</code></pre>

                <h4>Request æ¬„ä½èªªæ˜</h4>
                <table style="margin-top: 12px;">
                    <tr><th>æ¬„ä½</th><th>é¡å‹</th><th>å¿…å¡«</th><th>èªªæ˜</th></tr>
                    <tr>
                        <td><code>operator</code></td>
                        <td>string</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>ç‡Ÿé‹å•†åç¨±ï¼Œç³»çµ±æœƒæŸ¥è©¢å°æ‡‰çš„ operator.id</td>
                    </tr>
                    <tr>
                        <td><code>member_id</code></td>
                        <td>string</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>ç©å®¶å”¯ä¸€è­˜åˆ¥ç¢¼</td>
                    </tr>
                    <tr>
                        <td><code>game</code></td>
                        <td>string</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>éŠæˆ²åç¨±ï¼Œç³»çµ±æœƒæŸ¥è©¢å°æ‡‰çš„ game.id</td>
                    </tr>
                    <tr>
                        <td><code>currency</code></td>
                        <td>string</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>å¹£åˆ¥ä»£ç¢¼ (ä¾‹: USD, CNY, TWD)</td>
                    </tr>
                    <tr>
                        <td><code>free_rounds</code></td>
                        <td>int</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>å…è²»æ—‹è½‰æ¬¡æ•¸</td>
                    </tr>
                    <tr>
                        <td><code>bet_rate_cents</code></td>
                        <td>long</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>æ¯æ¬¡æ—‹è½‰çš„ä¸‹æ³¨é‡‘é¡ (å–®ä½: cents)</td>
                    </tr>
                    <tr>
                        <td><code>max_payout_cents</code></td>
                        <td>long</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>å–®å¼µç¥¨åˆ¸çš„æœ€å¤§æ´¾å½©ä¸Šé™ (å–®ä½: cents)</td>
                    </tr>
                    <tr>
                        <td><code>validity_days</code></td>
                        <td>int</td>
                        <td><span style="color: #ef4444; font-weight: 600;">âœ“</span></td>
                        <td>ç¥¨åˆ¸æœ‰æ•ˆå¤©æ•¸</td>
                    </tr>
                    <tr>
                        <td><code>reason</code></td>
                        <td>string?</td>
                        <td><span style="color: #94a3b8;">é¸å¡«</span></td>
                        <td>é€åˆ¸åŸå›  (ä¾‹: VIP Compensation, Birthday Gift)</td>
                    </tr>
                </table>

                <h4>Response æ¬„ä½èªªæ˜</h4>
                <table style="margin-top: 12px;">
                    <tr><th>æ¬„ä½</th><th>é¡å‹</th><th>èªªæ˜</th></tr>
                    <tr>
                        <td><code>ticket_id</code></td>
                        <td>string</td>
                        <td>ç¥¨åˆ¸å”¯ä¸€è­˜åˆ¥ç¢¼ (UUID)</td>
                    </tr>
                    <tr>
                        <td><code>campaign_id</code></td>
                        <td>string</td>
                        <td>é—œè¯çš„æ´»å‹• ID (ç”±å¾Œç«¯è‡ªå‹•é—œè¯)</td>
                    </tr>
                    <tr>
                        <td><code>status</code></td>
                        <td>string</td>
                        <td>ç¥¨åˆ¸ç‹€æ…‹ï¼Œé è¨­ç‚º "pending"</td>
                    </tr>
                    <tr>
                        <td><code>expires_at</code></td>
                        <td>DateTimeOffset</td>
                        <td>ç¥¨åˆ¸éæœŸæ™‚é–“ (UTC)</td>
                    </tr>
                </table>

                <h4>å…§éƒ¨è™•ç†æµç¨‹</h4>
                <ol style="color: #94a3b8; padding-left: 20px; font-size: 14px; margin-top: 12px;">
                    <li>æ ¹æ“š <code>operator</code> åç¨±æŸ¥è©¢ operator.id</li>
                    <li>æ ¹æ“š <code>game</code> åç¨±æŸ¥è©¢ game.id</li>
                    <li>é©—è­‰ <code>member_id</code> å­˜åœ¨</li>
                    <li>ç”¢ç”Ÿ <code>ticket_id</code> (UUID)</li>
                    <li>è¨ˆç®— <code>expires_at</code> = now + validity_days</li>
                    <li>è‡ªå‹•é—œè¯æˆ–å»ºç«‹å°æ‡‰çš„ <code>campaign_id</code></li>
                    <li>å¯«å…¥ OceanBase <code>free_round_bonus_ticket</code></li>
                    <li>å¯«å…¥ OceanBase <code>free_round_bonus_ticket_details</code></li>
                    <li>æ›´æ–° Redis å¿«å– (å¯é¸)</li>
                    <li>ç™¼é€ Kafka Event: <code>ticket.created</code></li>
                </ol>

                <h4>éŒ¯èª¤å›æ‡‰ (400 Bad Request)</h4>
<pre><code>{
  <span class="property">"error"</span>: <span class="string">"ValidationError"</span>,
  <span class="property">"message"</span>: <span class="string">"Invalid operator name"</span>
}</code></pre>

                <div class="note warning" style="margin-top: 16px;">
                    <div class="note-title">âš ï¸ é‡è¦èªªæ˜</div>
                    <ul style="margin-left: 20px; color: #fef3c7;">
                        <li>Request <strong>ä¸éœ€è¦</strong>æä¾› <code>campaign_id</code>ï¼Œç”±å¾Œç«¯è‡ªå‹•è™•ç†</li>
                        <li>Response æœƒè¿”å›é—œè¯çš„ <code>campaign_id</code></li>
                        <li><code>operator</code> å’Œ <code>game</code> ä½¿ç”¨åç¨±ï¼Œç³»çµ±æœƒè‡ªå‹•è½‰æ›ç‚º ID</li>
                        <li>æ‰€æœ‰é‡‘é¡å–®ä½çµ±ä¸€ä½¿ç”¨ <strong>cents (åˆ†)</strong></li>
                        <li>ç¥¨åˆ¸å»ºç«‹å¾Œç‹€æ…‹ç‚º <code>pending</code>ï¼Œç­‰å¾…ç©å®¶ä½¿ç”¨</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Back Office API -->
        <section id="spec-backoffice-api">
            <h2>ğŸ¢ Back Office API (Campaign Management)</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">å¾Œå°å»ºç«‹é–€æª»æ¨¡å¼æ´»å‹•ï¼Œè¨­å®šå¤šå±¤ç´šé–€æª»ã€‚</p>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/api/backoffice/campaigns</span>
                </div>
                <p class="endpoint-desc">å»ºç«‹ FRB æ´»å‹• (å«å¤šå±¤ç´šé–€æª»)</p>
                
                <h4>Request Body</h4>
<pre><code>{
  <span class="property">"name"</span>: <span class="string">"Spring Festival 2026"</span>,
  <span class="property">"operator_id"</span>: <span class="string">"op_001"</span>,
  <span class="property">"game_ids"</span>: [<span class="string">"wild_bounty"</span>, <span class="string">"fortune_tiger"</span>],
  <span class="property">"start_at"</span>: <span class="string">"2026-01-20T00:00:00Z"</span>,
  <span class="property">"end_at"</span>: <span class="string">"2026-02-20T00:00:00Z"</span>,
  <span class="property">"levels"</span>: [
    {
      <span class="property">"level"</span>: <span class="number">1</span>,
      <span class="property">"currency"</span>: <span class="string">"USD"</span>,
      <span class="property">"threshold_cents"</span>: <span class="number">10000</span>,         <span class="comment">// ä¸‹æ³¨ $100 é”æ¨™</span>
      <span class="property">"free_rounds"</span>: <span class="number">5</span>,
      <span class="property">"bet_rate_cents"</span>: <span class="number">50</span>,
      <span class="property">"max_payout_cents"</span>: <span class="number">25000</span>,
      <span class="property">"ticket_count_limit"</span>: <span class="number">1000</span>,        <span class="comment">// æœ€å¤šç™¼ 1000 å¼µ</span>
      <span class="property">"ticket_validity_days"</span>: <span class="number">7</span>
    },
    {
      <span class="property">"level"</span>: <span class="number">2</span>,
      <span class="property">"currency"</span>: <span class="string">"USD"</span>,
      <span class="property">"threshold_cents"</span>: <span class="number">50000</span>,         <span class="comment">// ä¸‹æ³¨ $500 é”æ¨™</span>
      <span class="property">"free_rounds"</span>: <span class="number">10</span>,
      <span class="property">"bet_rate_cents"</span>: <span class="number">100</span>,
      <span class="property">"max_payout_cents"</span>: <span class="number">100000</span>,
      <span class="property">"ticket_count_limit"</span>: <span class="number">500</span>,
      <span class="property">"ticket_validity_days"</span>: <span class="number">7</span>
    },
    {
      <span class="property">"level"</span>: <span class="number">3</span>,
      <span class="property">"currency"</span>: <span class="string">"USD"</span>,
      <span class="property">"threshold_cents"</span>: <span class="number">100000</span>,        <span class="comment">// ä¸‹æ³¨ $1000 é”æ¨™</span>
      <span class="property">"free_rounds"</span>: <span class="number">20</span>,
      <span class="property">"bet_rate_cents"</span>: <span class="number">200</span>,
      <span class="property">"max_payout_cents"</span>: <span class="number">500000</span>,
      <span class="property">"ticket_count_limit"</span>: <span class="number">100</span>,
      <span class="property">"ticket_validity_days"</span>: <span class="number">14</span>
    }
  ]
}</code></pre>

                <h4>Response - Success (201)</h4>
<pre><code>{
  <span class="property">"success"</span>: <span class="keyword">true</span>,
  <span class="property">"data"</span>: {
    <span class="property">"campaign_id"</span>: <span class="number">12345</span>,
    <span class="property">"name"</span>: <span class="string">"Spring Festival 2026"</span>,
    <span class="property">"status"</span>: <span class="string">"scheduled"</span>,
    <span class="property">"levels_count"</span>: <span class="number">3</span>,
    <span class="property">"max_cost_cents"</span>: <span class="number">125000000</span>       <span class="comment">// é ä¼°æœ€å¤§æˆæœ¬</span>
  }
}</code></pre>

                <div class="note warning">
                    <div class="note-title">âš ï¸ æˆæœ¬è¨ˆç®—å…¬å¼</div>
                    <code>max_cost = SUM(ticket_count_limit[i] * max_payout_cents[i])</code>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/backoffice/campaigns/{campaign_id}</span>
                </div>
                <p class="endpoint-desc">æŸ¥è©¢æ´»å‹•è©³æƒ…èˆ‡å„å±¤ç´šè¨­å®š</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-put">PUT</span>
                    <span class="endpoint-path">/api/backoffice/campaigns/{campaign_id}</span>
                </div>
                <p class="endpoint-desc">æ›´æ–°æ´»å‹•è¨­å®š (åƒ…é™æ´»å‹•é–‹å§‹å‰)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-get">GET</span>
                    <span class="endpoint-path">/api/backoffice/campaigns/{campaign_id}/stats</span>
                </div>
                <p class="endpoint-desc">æŸ¥è©¢æ´»å‹•çµ±è¨ˆ (å·²ç™¼åˆ¸æ•¸ã€å·²ä½¿ç”¨ã€æˆæœ¬ç­‰)</p>
                
                <h4>Response</h4>
<pre><code>{
  <span class="property">"campaign_id"</span>: <span class="number">12345</span>,
  <span class="property">"levels"</span>: [
    {
      <span class="property">"level"</span>: <span class="number">1</span>,
      <span class="property">"ticket_count_limit"</span>: <span class="number">1000</span>,
      <span class="property">"ticket_count_issued"</span>: <span class="number">523</span>,
      <span class="property">"ticket_count_used"</span>: <span class="number">412</span>,
      <span class="property">"total_payout_cents"</span>: <span class="number">8234500</span>
    }
  ],
  <span class="property">"total_cost_cents"</span>: <span class="number">15678900</span>
}</code></pre>
            </div>
        </section>

        <!-- MySQL Schema -->
        <section id="spec-mysql">
            <h2>ğŸ—„ï¸ MySQL Schema</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Database: <code>five_game</code> @ <code>mysql-rds</code></p>

            <h3>campaign</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 12px;">å„²å­˜æ´»å‹•é…ç½®èˆ‡å…ƒè³‡æ–™</p>
<pre><code><span class="keyword">CREATE TABLE</span> <span class="type">campaign</span> (
    <span class="property">id</span>                      <span class="type">VARCHAR(36)</span> <span class="keyword">PRIMARY KEY DEFAULT</span> uuid(),
    <span class="property">code</span>                    <span class="type">VARCHAR(15)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">type</span>                    <span class="type">TINYINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">status</span>                  <span class="type">TINYINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">end_reason</span>              <span class="type">TINYINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">start_at</span>                <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span>,
    <span class="property">end_at</span>                  <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span>,
    <span class="property">visibility_end_at</span>       <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span>,
    <span class="property">actual_end_at</span>           <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    <span class="property">timezone</span>                <span class="type">TIME</span> <span class="keyword">NOT NULL</span>,
    <span class="property">countdown_hourly</span>        <span class="type">SMALLINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">cost_notify_proportion</span>  <span class="type">TINYINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">prize_notify_proportion</span> <span class="type">TINYINT</span> <span class="keyword">NULL</span>,
    <span class="property">budget</span>                  <span class="type">JSON</span> <span class="keyword">NULL</span>,
    <span class="property">last_status</span>             <span class="type">TINYINT</span> <span class="keyword">NULL</span>,
    <span class="property">creator_id</span>              <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">created_at</span>              <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span>,
    <span class="property">updater_id</span>              <span class="type">VARCHAR(36)</span> <span class="keyword">NULL</span>,
    <span class="property">updated_at</span>              <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    <span class="property">is_archived</span>             <span class="type">BIT(1)</span> <span class="keyword">NOT NULL DEFAULT</span> <span class="number">0</span>,
    <span class="property">deleted</span>                 <span class="type">BIT(1)</span> <span class="keyword">NOT NULL DEFAULT</span> <span class="number">0</span>,
    
    <span class="keyword">INDEX</span> idx_deleted (deleted)
);</code></pre>

            <h3>campaign_frb_level</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 12px;">å®šç¾© FRB æ´»å‹•çš„éšæ¢¯é…ç½®</p>
<pre><code><span class="keyword">CREATE TABLE</span> <span class="type">campaign_frb_level</span> (
    <span class="property">id</span>                    <span class="type">BIGINT</span> <span class="keyword">PRIMARY KEY AUTO_INCREMENT</span>,
    <span class="property">campaign_id</span>           <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">level</span>                 <span class="type">INT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">currency_sn</span>           <span class="type">INT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">threshold_cents</span>       <span class="type">BIGINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">reward_count</span>          <span class="type">INT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">max_payout_cents</span>      <span class="type">BIGINT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">ticket_count_limit</span>    <span class="type">INT</span> <span class="keyword">NOT NULL</span>,
    <span class="property">ticket_validity_days</span>  <span class="type">INT</span> <span class="keyword">NOT NULL DEFAULT</span> <span class="number">3</span>,
    <span class="property">created_at</span>            <span class="type">DATETIME</span> <span class="keyword">NOT NULL DEFAULT CURRENT_TIMESTAMP</span>,
    <span class="property">updated_at</span>            <span class="type">DATETIME</span> <span class="keyword">NULL ON UPDATE CURRENT_TIMESTAMP</span>,
    
    <span class="keyword">INDEX</span> idx_campaign_id (campaign_id),
    <span class="keyword">INDEX</span> idx_currency_sn (currency_sn)
);</code></pre>

            <div class="note">
                <div class="note-title">ğŸ“Š æ¬„ä½èªªæ˜</div>
                <table style="margin-top: 12px;">
                    <tr><th>æ¬„ä½</th><th>èªªæ˜</th></tr>
                    <tr><td><code>threshold_cents</code></td><td>é–€æª»é‡‘é¡ (Cent)</td></tr>
                    <tr><td><code>reward_count</code></td><td>çå‹µæ¬¡æ•¸ (Free Rounds)</td></tr>
                    <tr><td><code>max_payout_cents</code></td><td>å–®å¼µç¥¨åˆ¸æœ€å¤§æ´¾å½© (Cent)</td></tr>
                    <tr><td><code>ticket_count_limit</code></td><td>è©²éšæ¢¯å¯ç™¼æ”¾çš„ç¥¨åˆ¸ç¸½æ•¸é™åˆ¶</td></tr>
                    <tr><td><code>ticket_validity_days</code></td><td>ç¥¨åˆ¸æœ‰æ•ˆå¤©æ•¸</td></tr>
                </table>
            </div>
        </section>

        <!-- OceanBase Schema -->
        <section id="spec-oceanbase">
            <h2>ğŸŒŠ OceanBase Schema</h2>
            <p style="color: #94a3b8; margin-bottom: 24px;">Database: <code>five_game_trans_dev</code> @ <code>oceanbase-dev</code></p>

            <h3>free_round_bonus_ticket</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 12px;">ä»£è¡¨ç™¼æ”¾çµ¦æœƒå“¡çš„ FRB ç¥¨åˆ¸</p>
<pre><code><span class="keyword">CREATE TABLE</span> <span class="type">free_round_bonus_ticket</span> (
    <span class="property">id</span>                      <span class="type">VARCHAR(36)</span> <span class="keyword">PRIMARY KEY</span>,
    <span class="property">operator_id</span>             <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">member_id</span>               <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">account</span>                 <span class="type">VARCHAR(64)</span> <span class="keyword">NULL</span>,
    <span class="property">campaign_id</span>             <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">expired_at</span>              <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    <span class="property">created_at</span>              <span class="type">TIMESTAMP(3)</span> <span class="keyword">NOT NULL DEFAULT CURRENT_TIMESTAMP(3)</span>,
    <span class="property">updated_at</span>              <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    
    <span class="keyword">PRIMARY KEY</span> (id, member_id),
    <span class="keyword">INDEX</span> idx_campaign_id (campaign_id),
    <span class="keyword">INDEX</span> idx_expired_at (expired_at),
    <span class="keyword">INDEX</span> idx_created_at (created_at)
);</code></pre>

            <h3>free_round_bonus_ticket_details</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 12px;">åŒ…å«ç¥¨åˆ¸çš„éŠæˆ²é…ç½®èˆ‡ç‹€æ…‹</p>
<pre><code><span class="keyword">CREATE TABLE</span> <span class="type">free_round_bonus_ticket_details</span> (
    <span class="property">id</span>                      <span class="type">VARCHAR(36)</span> <span class="keyword">PRIMARY KEY</span>,
    <span class="property">ticket_id</span>               <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">level</span>                   <span class="type">INT(11)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">game_id</span>                 <span class="type">VARCHAR(12)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">threshold</span>               <span class="type">INT(10) UNSIGNED</span> <span class="keyword">NOT NULL</span>,
    <span class="property">rate</span>                    <span class="type">INT(10) UNSIGNED</span> <span class="keyword">NOT NULL</span>,
    <span class="property">bet</span>                     <span class="type">INT(10) UNSIGNED</span> <span class="keyword">NOT NULL</span>,
    <span class="property">payout_multiplier_limit</span> <span class="type">INT(11)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">max_payout_cents</span>        <span class="type">BIGINT(20) UNSIGNED</span> <span class="keyword">NOT NULL</span>,
    <span class="property">reward_count</span>            <span class="type">INT(10) UNSIGNED</span> <span class="keyword">NOT NULL</span>,
    <span class="property">total_win</span>               <span class="type">BIGINT(20) UNSIGNED</span> <span class="keyword">NULL</span>,
    <span class="property">encrypted</span>               <span class="type">LONGBLOB</span> <span class="keyword">NOT NULL</span>,
    <span class="property">status</span>                  <span class="type">VARCHAR(16)</span> <span class="keyword">NOT NULL DEFAULT</span> <span class="string">'pending'</span>,
    <span class="property">finished_at</span>             <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    <span class="property">created_at</span>              <span class="type">TIMESTAMP(3)</span> <span class="keyword">NOT NULL DEFAULT CURRENT_TIMESTAMP(3)</span>,
    <span class="property">updated_at</span>              <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span>,
    
    <span class="keyword">INDEX</span> idx_ticket_id (ticket_id),
    <span class="keyword">INDEX</span> idx_game_id (game_id),
    <span class="keyword">INDEX</span> idx_created_at (created_at)
);</code></pre>

            <h3>free_round_bonus_ticket_mapping</h3>
            <p style="color: #94a3b8; font-size: 13px; margin-bottom: 12px;">æ˜ å°„ç¥¨åˆ¸è©³æƒ…åˆ°æœƒè¨ˆäº¤æ˜“è¨˜éŒ„</p>
<pre><code><span class="keyword">CREATE TABLE</span> <span class="type">free_round_bonus_ticket_mapping</span> (
    <span class="property">id</span>                      <span class="type">VARCHAR(36)</span> <span class="keyword">PRIMARY KEY</span>,
    <span class="property">frb_ticket_details_id</span>   <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">accounting_id</span>           <span class="type">VARCHAR(36)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">accounting_win</span>          <span class="type">BIGINT(20)</span> <span class="keyword">NOT NULL</span>,
    <span class="property">created_at</span>              <span class="type">TIMESTAMP(3)</span> <span class="keyword">NOT NULL DEFAULT CURRENT_TIMESTAMP(3)</span>,
    
    <span class="keyword">PRIMARY KEY</span> (id, accounting_id),
    <span class="keyword">INDEX</span> idx_frb_ticket_details_id (frb_ticket_details_id),
    <span class="keyword">INDEX</span> idx_created_at (created_at)
);</code></pre>

            <div class="note">
                <div class="note-title">ğŸ”— è³‡æ–™è¡¨é—œè¯</div>
                <pre style="background: #0f172a; padding: 16px; border-radius: 8px; margin-top: 12px;"><code>campaign (MySQL)
  â””â”€1:Nâ”€> campaign_frb_level (MySQL)
            â””â”€levelâ”€> free_round_bonus_ticket_details (OceanBase)
                        â””â”€threshold_cents, max_payout_cents

free_round_bonus_ticket (OceanBase)
  â””â”€1:Nâ”€> free_round_bonus_ticket_details
            â””â”€1:Nâ”€> free_round_bonus_ticket_mapping
                      â””â”€accounting_id (äº¤æ˜“è¨˜éŒ„)</code></pre>
            </div>

            <div class="note warning" style="margin-top: 16px;">
                <div class="note-title">ğŸ’¡ è¨­è¨ˆè¦é»</div>
                <ul style="margin-left: 20px; color: #fef3c7;">
                    <li>MySQL å„²å­˜æ´»å‹•é…ç½®èˆ‡éšæ¢¯è¨­å®š (è®€å¤šå¯«å°‘)</li>
                    <li>OceanBase å„²å­˜ç¥¨åˆ¸å¯¦ä¾‹èˆ‡äº¤æ˜“è¨˜éŒ„ (å¯«å¤šè®€å°‘)</li>
                    <li><code>status</code> ç‹€æ…‹: <code>pending</code>, <code>inuse</code>, <code>completed</code>, <code>expired</code></li>
                    <li><code>encrypted</code> æ¬„ä½å„²å­˜åŠ å¯†çš„éŠæˆ²ç‹€æ…‹è³‡æ–™</li>
                    <li><code>total_win</code> ç´¯è¨ˆè©²ç¥¨åˆ¸çš„ç¸½çé‡‘</li>
                </ul>
            </div>
        </section>

        <!-- Redis -->
        <section id="spec-redis">
            <h2>âš¡ Redis Structure</h2>
            <h3>Key Patterns</h3>
            <table>
                <tr><th>Key Pattern</th><th>Type</th><th>Description</th></tr>
                <tr><td><code>frb:ticket:{ticket_id}</code></td><td>HASH</td><td>ç¥¨åˆ¸å³æ™‚ç‹€æ…‹</td></tr>
                <tr><td><code>frb:player:{op}:{member}:tickets</code></td><td>SET</td><td>ç©å®¶ç¥¨åˆ¸æ¸…å–®</td></tr>
                <tr><td><code>frb:player:{op}:{member}:totalBet</code></td><td>STRING</td><td>ç´¯è¨ˆä¸‹æ³¨ (é–€æª»æ¨¡å¼)</td></tr>
                <tr><td><code>frb:player:{op}:{member}:level</code></td><td>STRING</td><td>ç©å®¶ç•¶å‰å±¤ç´š</td></tr>
            </table>
        </section>

        <!-- Pub/Sub -->
        <section id="spec-pubsub">
            <h2>ğŸ“¡ Redis Pub/Sub Events</h2>
            
            <div class="pubsub-channel">
                <div class="channel-name">ğŸ“¤ frb:ticket:created</div>
                <p style="color: #fecaca; font-size: 13px; margin-bottom: 12px;">Publisher: FRB Service | Subscriber: GameServer</p>
<pre style="background: #450a0a; border-color: #7f1d1d;"><code>{
  <span class="property">"event"</span>: <span class="string">"ticket:created"</span>,
  <span class="property">"ticket_id"</span>: <span class="string">"frb_ticket_abc123"</span>,
  <span class="property">"member_id"</span>: <span class="string">"player_12345"</span>,
  <span class="property">"game_id"</span>: <span class="string">"wild_bounty"</span>,
  <span class="property">"free_rounds"</span>: <span class="number">10</span>,
  <span class="property">"max_payout_cents"</span>: <span class="number">50000</span>
}</code></pre>
            </div>

            <div class="pubsub-channel" style="background: linear-gradient(135deg, #14532d 0%, #166534 100%);">
                <div class="channel-name" style="color: #86efac;">ğŸ“¤ frb:ticket:completed</div>
                <p style="color: #bbf7d0; font-size: 13px; margin-bottom: 12px;">Publisher: GameServer | Subscriber: FRB Service</p>
<pre style="background: #052e16; border-color: #166534;"><code>{
  <span class="property">"event"</span>: <span class="string">"ticket:completed"</span>,
  <span class="property">"ticket_id"</span>: <span class="string">"frb_ticket_abc123"</span>,
  <span class="property">"status"</span>: <span class="string">"completed"</span>,
  <span class="property">"rounds_played"</span>: <span class="number">10</span>,
  <span class="property">"total_payout_cents"</span>: <span class="number">35000</span>
}</code></pre>
            </div>
        </section>
    </div>

    <!-- ==================== Q&A TAB ==================== -->
    <div id="qa" class="tab-content">
        <div style="text-align: center; margin-bottom: 32px;">
            <h2 style="border: none; display: block; font-size: 24px;">Technical Q&A</h2>
            <p style="color: #94a3b8;">æŠ€è¡“è¨è«–è­°é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ | Meeting: 2026/01/09</p>
        </div>

        <!-- Summary - Moved to top -->
        <section style="margin-bottom: 32px;">
            <h2>ğŸ“‹ æ±ºç­–æ‘˜è¦</h2>
            <table>
                <tr><th>è­°é¡Œ</th><th>æ±ºç­–</th><th>ç‹€æ…‹</th></tr>
                <tr>
                    <td>Q1: Max Payout è¨ˆç®—æ™‚æ©Ÿ</td>
                    <td>æ¯æ¬¡ Spin å³æ™‚è¨ˆç®—ï¼Œç«‹å³æ´¾ç™¼çé‡‘</td>
                    <td><span class="status status-completed">âœ… Confirmed</span></td>
                </tr>
                <tr>
                    <td>Q1-1: Cap é”æ¨™å¾Œå‰©é¤˜ Spin</td>
                    <td>å‰©é¤˜ Spin ä¸åŸ·è¡Œï¼ŒTicket ç›´æ¥ completed</td>
                    <td><span class="status status-completed">âœ… Confirmed</span></td>
                </tr>
                <tr>
                    <td>Q2: Accounting è¨˜éŒ„æ–¹å¼</td>
                    <td>æ¯æ¬¡ Spin å³æ™‚æ´¾ç™¼ï¼Œç„¡éœ€ç­‰ Ticket çµæŸçµç®—</td>
                    <td><span class="status status-completed">âœ… Confirmed</span></td>
                </tr>
                <tr style="background: rgba(251, 191, 36, 0.1);">
                    <td>Q3: æ´»å‹•æˆæœ¬æ§åˆ¶</td>
                    <td>å¾…ç¢ºèªï¼šPer-Ticket Max Payout Ã— Ticket æ•¸é‡é™åˆ¶</td>
                    <td><span class="status status-pending">â³ Pending</span></td>
                </tr>
                <tr style="background: rgba(251, 191, 36, 0.1);">
                    <td>Q3-1: æ´»å‹•çµæŸå¾Œç¥¨åˆ¸å¯ç”¨æ€§</td>
                    <td>å¾… Q3 ç¢ºèªå¾Œè¨è«–</td>
                    <td><span class="status status-pending">â³ Pending</span></td>
                </tr>
                <tr>
                    <td>Q4: Ticket éæœŸè™•ç†</td>
                    <td>å› å³æ™‚æ´¾ç™¼ï¼ŒéæœŸæ™‚ç„¡éœ€é‡‘é¡èª¿æ•´</td>
                    <td><span class="status status-completed">âœ… Resolved</span></td>
                </tr>
            </table>
        </section>

        <!-- Confirmed Decisions -->
        <div class="decisions">
            <h2>âœ… å·²ç¢ºèªæ±ºç­–</h2>
            <ul class="decision-list">
                <li>
                    <span class="decision-number">1</span>
                    <span>ç›¸åŒæ´»å‹•çš„é–€æª»ï¼Œæœƒé©ç”¨è©²æ´»å‹•çš„<strong>æ‰€æœ‰ç‡Ÿé‹å•†</strong>ï¼Œä¸æœƒ by ç‡Ÿé‹å•†ä¸åŒ</span>
                </li>
                <li>
                    <span class="decision-number">2</span>
                    <span>ç‚ºæ§åˆ¶æˆæœ¬ï¼Œ<strong>Max Payout ç‚ºå¿…å¡«</strong>æ¬„ä½</span>
                </li>
                <li>
                    <span class="decision-number">3</span>
                    <span>éœ€åŠ å…¥ <strong>Ticket æœ‰æ•ˆæ—¥</strong>ï¼Œé¿å…æ´»å‹•çµæŸç©å®¶ç„¡æ³•ä½¿ç”¨ Ticket å°è‡´é«”é©—ä¸å¥½</span>
                </li>
                <li>
                    <span class="decision-number">4</span>
                    <span>è‹¥ Ticket åœ¨åˆ°æœŸå‰æœªä½¿ç”¨å®Œç•¢ï¼Œåˆ°æœŸæ™‚æœƒ<strong>çµ±ä¸€çµç®—å·²ä½¿ç”¨ Round çš„ Payout</strong> æ´¾çµ¦ç©å®¶</span>
                </li>
            </ul>
        </div>

        <!-- Q1 -->
        <div class="qa-card" style="border: 2px solid #10b981;">
            <div class="question" style="background: linear-gradient(135deg, #14532d 0%, #166534 100%);">
                <span class="q-badge" style="background: #10b981;">Q1</span>
                <span>GS ç›®å‰æ¯ä¸€å€‹ spin æœƒçµç®—ä¸¦ç•°å‹• walletï¼Œè¦å¦‚ä½•ä»¥ ticket ç‚ºå–®ä½åˆ¤æ–· max payout ä¸¦ç•°å‹• walletï¼Ÿ</span>
                <span style="margin-left: auto; background: #10b981; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">âœ… REVIEWED</span>
            </div>
            <div class="answer">
                <div class="answer-label">ğŸ’¡ çµè«–</div>
                <p>æ¡ç”¨<strong>å³æ™‚ Cap è¨ˆç®—</strong>ï¼šæ¯æ¬¡ Spin æ™‚å³æ™‚è¨ˆç®—ä¸¦å¥—ç”¨ Max Payout ä¸Šé™ï¼Œç«‹å³æ´¾ç™¼çé‡‘ã€‚</p>
                
                <div class="comparison">
                    <div class="comparison-box before">
                        <h4>âŒ ç¾æœ‰æµç¨‹ (ç„¡ Cap)</h4>
<pre><code>Spin 1: Win 10 â†’ Wallet +10
Spin 2: Win 25 â†’ Wallet +25
Total: Wallet +35</code></pre>
                    </div>
                    <div class="comparison-box after">
                        <h4>âœ… æ–°æµç¨‹ (å³æ™‚ Cap)</h4>
<pre><code>Max Payout = 30
Spin 1: Win 10 â†’ Wallet +10 (ç´¯è¨ˆ: 10)
Spin 2: Win 25 â†’ Wallet +20 (Cap!)
Total: Wallet +30</code></pre>
                    </div>
                </div>

                <div class="solution recommended">
                    <div class="solution-header">
                        <span class="solution-title">Cap è¨ˆç®—å…¬å¼</span>
                        <span class="badge-recommended">CONFIRMED</span>
                    </div>
<pre><code>actual_payout = min(raw_win, max(<span class="number">0</span>, max_payout - accumulated_payout))</code></pre>
                </div>
            </div>
        </div>

        <!-- Q1-1: Reviewed -->
        <div class="qa-card" style="border: 2px solid #10b981;">
            <div class="question" style="background: linear-gradient(135deg, #14532d 0%, #166534 100%);">
                <span class="q-badge" style="background: #10b981;">Q1-1</span>
                <span>è‹¥æ¡ç”¨å³æ™‚ Cap è¨ˆç®—ï¼Œé”åˆ° Max Payout å¾Œå‰©é¤˜çš„ Spin è¦å¦‚ä½•è™•ç†ï¼Ÿ</span>
                <span style="margin-left: auto; background: #10b981; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">âœ… REVIEWED</span>
            </div>
            <div class="answer">
                <div class="answer-label">ğŸ’¡ çµè«–</div>
                
                <div class="solution recommended">
                    <div class="solution-header">
                        <span class="solution-title">Cap é”æ¨™å¾Œç«‹å³çµæŸ Ticket</span>
                        <span class="badge-recommended">CONFIRMED</span>
                    </div>
                    <p>ç•¶ç©å®¶é”åˆ° Max Payout æ™‚ï¼Œ<strong>å‰©é¤˜çš„ Spin ä¸å†åŸ·è¡Œ</strong>ï¼ŒTicket ç›´æ¥æ¨™è¨˜ç‚º completedã€‚</p>
                </div>
                
                <table style="margin-top: 16px;">
                    <tr><th>Spin</th><th>Raw Win</th><th>Accumulated</th><th>Actual Payout</th><th>çµæœ</th></tr>
                    <tr><td>1</td><td>200</td><td>200</td><td style="color: #86efac;">200</td><td></td></tr>
                    <tr><td>2</td><td>350</td><td>500</td><td style="color: #86efac;">300 (Cap!)</td><td style="color: #f472b6; font-weight: 600;">â†’ early_completed</td></tr>
                    <tr style="color: #64748b; text-decoration: line-through;">
                        <td>3</td><td>-</td><td>-</td><td>-</td><td rowspan="3">ä¸åŸ·è¡Œ</td>
                    </tr>
                    <tr style="color: #64748b; text-decoration: line-through;">
                        <td>4</td><td>-</td><td>-</td><td>-</td>
                    </tr>
                    <tr style="color: #64748b; text-decoration: line-through;">
                        <td>5</td><td>-</td><td>-</td><td>-</td>
                    </tr>
                </table>

                <div class="note" style="margin-top: 16px;">
                    <div class="note-title">âœ¨ å„ªé»</div>
                    <ul style="margin-left: 16px; color: #94a3b8; font-size: 13px;">
                        <li>é¿å… 0 æ´¾å½©çš„å°·å°¬é«”é©—</li>
                        <li>é¿å… Feature Game è§¸ç™¼ä½†ç„¡çé‡‘çš„å›°æƒ‘</li>
                        <li>ç©å®¶æ¸…æ¥šçŸ¥é“å·²ç²å¾—æœ€å¤§çé‡‘</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Q2 -->
        <div class="qa-card" style="border: 2px solid #10b981;">
            <div class="question" style="background: linear-gradient(135deg, #14532d 0%, #166534 100%);">
                <span class="q-badge" style="background: #10b981;">Q2</span>
                <span>è¦å¦‚ä½•å°‡ä¸€å¼µ ticket çš„ total win åˆ†æ´¾çµ¦å¤šå€‹ round çš„ accountingï¼Ÿ</span>
                <span style="margin-left: auto; background: #10b981; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">âœ… REVIEWED</span>
            </div>
            <div class="answer">
                <div class="answer-label">ğŸ’¡ çµè«–</div>
                
                <div class="solution recommended">
                    <div class="solution-header">
                        <span class="solution-title">æ¯æ¬¡ Spin å³æ™‚æ´¾ç™¼çé‡‘</span>
                        <span class="badge-recommended">CONFIRMED</span>
                    </div>
                    <p>å› ç‚ºæ¡ç”¨å³æ™‚ Cap è¨ˆç®—ï¼Œ<strong>æ¯æ¬¡ Spin å°±ç«‹å³æ´¾ç™¼çé‡‘</strong>ï¼Œä¸éœ€è¦ç­‰æ•´å€‹ Ticket çµæŸæ‰çµç®—ã€‚</p>
                </div>

                <table style="margin-top: 16px;">
                    <tr><th>Round</th><th>raw_win</th><th>actual_payout</th><th>Wallet ç•°å‹•</th><th>bet_type</th></tr>
                    <tr><td>1</td><td>10</td><td>10</td><td style="color: #86efac;">+10 (å³æ™‚)</td><td><code>4096</code></td></tr>
                    <tr><td>2</td><td>25</td><td>20</td><td style="color: #86efac;">+20 (å³æ™‚)</td><td><code>4096</code></td></tr>
                </table>

                <div class="note" style="margin-top: 16px;">
                    <div class="note-title">âœ¨ å„ªé»</div>
                    <ul style="margin-left: 16px; color: #94a3b8; font-size: 13px;">
                        <li>ç„¡éœ€äº‹å¾Œæ²–éŠ·æˆ–èª¿æ•´</li>
                        <li>Accounting è¨˜éŒ„æ¸…æ™°ï¼ˆraw_win vs actual_payoutï¼‰</li>
                        <li>ä»¥ <code>bet_type = 4096</code> å€åˆ† FRB é¡å‹</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Q3 -->
        <div class="qa-card" style="border: 2px solid #f59e0b;">
            <div class="question" style="background: linear-gradient(135deg, #78350f 0%, #92400e 100%);">
                <span class="q-badge" style="background: #f59e0b;">Q3</span>
                <span>æ–°å¢äº† Ticket Max Payout ä¸¦é™åˆ¶ Ticket æ•¸é‡ï¼Œæ˜¯å¦é‚„éœ€è¦ä¿ç•™æ•´é«”æ´»å‹•æˆæœ¬ä¸Šé™ï¼Ÿ</span>
                <span style="margin-left: auto; background: #f59e0b; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">â³ PENDING REVIEW</span>
            </div>
            <div class="answer" style="background: #1c1917;">
                <div class="answer-label" style="color: #f59e0b;">âš ï¸ å¾…èˆ‡æŠ€è¡“é•· Review</div>
                
                <div class="solution" style="border-left-color: #f59e0b;">
                    <div class="solution-header">
                        <span class="solution-title">å»ºè­°ï¼šç§»é™¤æ•´é«”æ´»å‹•æˆæœ¬ä¸Šé™</span>
                        <span class="badge-alternative">PROPOSED</span>
                    </div>
                    <p>æœ‰äº† Per-Ticket Max Payout + Ticket æ•¸é‡é™åˆ¶ï¼Œæ•´é«”æˆæœ¬å·²å¯ç²¾ç¢ºè¨ˆç®—ï¼š</p>
<pre><code><span class="comment">// æ´»å‹•æœ€å¤§æˆæœ¬ = å„å±¤ç´šæˆæœ¬åŠ ç¸½</span>
max_cost = Î£ (ticket_count_limit[i] Ã— max_payout_cents[i])

Level 1: <span class="number">1000</span> tickets Ã— $<span class="number">250</span> = $<span class="number">250,000</span>
Level 2: <span class="number">500</span> tickets Ã— $<span class="number">1000</span> = $<span class="number">500,000</span>
Level 3: <span class="number">100</span> tickets Ã— $<span class="number">5000</span> = $<span class="number">500,000</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Max Cost: $<span class="number">1,250,000</span></code></pre>
                </div>
            </div>
        </div>

        <!-- Q3-1: Pending Review (depends on Q3) -->
        <div class="qa-card" style="border: 2px solid #f59e0b;">
            <div class="question" style="background: linear-gradient(135deg, #78350f 0%, #92400e 100%);">
                <span class="q-badge" style="background: #f59e0b;">Q3-1</span>
                <span>æ´»å‹•çµæŸå¾Œï¼Œç©å®¶æ‰‹ä¸Šçš„ç¥¨åˆ¸é‚„å¯ä»¥ä½¿ç”¨å—ï¼Ÿ</span>
                <span style="margin-left: auto; background: #f59e0b; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">â³ å¾… Q3 ç¢ºèª</span>
            </div>
            <div class="answer" style="background: #1c1917;">
                <div class="answer-label" style="color: #f59e0b;">âš ï¸ å¾…èˆ‡æŠ€è¡“é•· Review</div>
                
                <h4 style="color: #fbbf24; margin-top: 16px;">å•é¡Œæƒ…å¢ƒ</h4>
                <p style="margin-bottom: 16px;">æ´»å‹•å¯èƒ½å› ä»¥ä¸‹åŸå› çµæŸï¼š</p>
                <ul style="color: #fef3c7; padding-left: 20px; font-size: 14px; margin-bottom: 16px;">
                    <li>æ´»å‹•æ™‚é–“åˆ°æœŸï¼ˆä¾‹ï¼šæ´»å‹•åˆ° 1/10 çµæŸï¼‰</li>
                    <li>ç¥¨åˆ¸ç™¼æ”¾æ•¸é‡é”ä¸Šé™ï¼ˆticket_count_limitï¼‰</li>
                    <li>æ‰‹å‹•æå‰çµæŸæ´»å‹•</li>
                </ul>
                
                <table>
                    <tr><th>æƒ…å¢ƒ</th><th>å•é¡Œ</th></tr>
                    <tr>
                        <td>æ´»å‹• 1/10 çµæŸï¼Œç©å®¶ 1/9 ç²å¾—ç¥¨åˆ¸</td>
                        <td style="color: #fbbf24;">ç©å®¶ 1/11 ç™»å…¥ï¼Œç¥¨åˆ¸é‚„èƒ½ç”¨å—ï¼Ÿ</td>
                    </tr>
                    <tr>
                        <td>ç¥¨åˆ¸ç™¼å®Œå°è‡´æ´»å‹•æå‰çµæŸ</td>
                        <td style="color: #fbbf24;">æœ€å¾Œä¸€æ‰¹æ‹¿åˆ°ç¥¨åˆ¸çš„ç©å®¶é‚„èƒ½ç”¨å—ï¼Ÿ</td>
                    </tr>
                </table>

                <h4 style="color: #fbbf24; margin-top: 24px;">é—œéµå•é¡Œ</h4>
                <ul style="color: #fef3c7; padding-left: 20px; font-size: 14px;">
                    <li style="margin-bottom: 8px;"><strong>Ticket æœ‰æ•ˆæœŸ vs æ´»å‹•æœŸé–“</strong>ï¼šå…©è€…æ˜¯å¦ç¨ç«‹ï¼ŸTicket expires_at æ˜¯å¦æ‡‰è©²èˆ‡æ´»å‹• end_at è„«é‰¤ï¼Ÿ</li>
                    <li style="margin-bottom: 8px;"><strong>ç©å®¶é«”é©—</strong>ï¼šå¦‚æœæ´»å‹•çµæŸå°±ä¸èƒ½ç”¨ï¼Œç©å®¶å¯èƒ½æ„Ÿè¦ºè¢«ã€Œé¨™ã€</li>
                    <li style="margin-bottom: 8px;"><strong>æˆæœ¬æ§åˆ¶</strong>ï¼šå…è¨±æ´»å‹•çµæŸå¾Œç¹¼çºŒä½¿ç”¨ï¼Œæˆæœ¬æ˜¯å¦ä»å¯æ§ï¼Ÿï¼ˆå·²ç™¼åˆ¸æ•¸é‡å›ºå®šï¼‰</li>
                </ul>

                <h4 style="color: #fbbf24; margin-top: 24px;">å¯èƒ½æ–¹æ¡ˆ (å¾…è¨è«–)</h4>
                <div class="solutions">
                    <div class="solution" style="border-left-color: #f59e0b;">
                        <div class="solution-header">
                            <span class="solution-title">æ–¹æ¡ˆ Aï¼šTicket æœ‰æ•ˆæœŸç¨ç«‹æ–¼æ´»å‹•</span>
                            <span class="badge-alternative">OPTION</span>
                        </div>
                        <p>æ´»å‹•çµæŸåªå½±éŸ¿ã€Œç™¼åˆ¸ã€ï¼Œå·²ç™¼å‡ºçš„ç¥¨åˆ¸ä¾ç…§ expires_at æ±ºå®šæ˜¯å¦å¯ç”¨</p>
<pre><code><span class="comment">// æ´»å‹• 1/10 çµæŸï¼Œç¥¨åˆ¸ validity_days = 7</span>
ç©å®¶ 1/8 ç²å¾—ç¥¨åˆ¸ â†’ expires_at = 1/15
ç©å®¶ 1/11 ç™»å…¥ â†’ <span class="string">å¯ä»¥ä½¿ç”¨</span> (æœªéæœŸ)</code></pre>
                        <ul style="color: #94a3b8; font-size: 12px; margin-top: 8px; padding-left: 16px;">
                            <li>âœ… ç©å®¶é«”é©—å¥½ï¼Œæ‹¿åˆ°çš„ç¥¨åˆ¸ä¿è­‰èƒ½ç”¨</li>
                            <li>âœ… æˆæœ¬ä»å¯æ§ï¼ˆå·²ç™¼åˆ¸æ•¸é‡ Ã— max_payoutï¼‰</li>
                            <li>âŒ æ´»å‹•ã€ŒçµæŸã€å¾Œä»æœ‰æˆæœ¬æ”¯å‡º</li>
                        </ul>
                    </div>
                    <div class="solution" style="border-left-color: #f59e0b;">
                        <div class="solution-header">
                            <span class="solution-title">æ–¹æ¡ˆ Bï¼šæ´»å‹•çµæŸ = æ‰€æœ‰ç¥¨åˆ¸å¤±æ•ˆ</span>
                            <span class="badge-alternative">OPTION</span>
                        </div>
                        <p>æ´»å‹•çµæŸæ™‚ï¼Œå¼·åˆ¶å°‡æ‰€æœ‰æœªå®Œæˆç¥¨åˆ¸æ¨™è¨˜ç‚º expired</p>
                        <ul style="color: #94a3b8; font-size: 12px; margin-top: 8px; padding-left: 16px;">
                            <li>âœ… æˆæœ¬å®Œå…¨å¯æ§ï¼Œæ´»å‹•çµæŸå³æ­¢æ</li>
                            <li>âŒ ç©å®¶é«”é©—å·®ï¼Œå‰›æ‹¿åˆ°çš„ç¥¨åˆ¸å¯èƒ½ç«‹åˆ»å¤±æ•ˆ</li>
                            <li>âŒ éœ€è¦é¡å¤–çš„æ‰¹æ¬¡è™•ç†é‚è¼¯</li>
                        </ul>
                    </div>
                    <div class="solution" style="border-left-color: #f59e0b;">
                        <div class="solution-header">
                            <span class="solution-title">æ–¹æ¡ˆ Cï¼šæ´»å‹•çµæŸå¾Œçµ¦äºˆå¯¬é™æœŸ</span>
                            <span class="badge-alternative">OPTION</span>
                        </div>
                        <p>æ´»å‹•çµæŸå¾Œï¼Œçµ¦äºˆå›ºå®šå¤©æ•¸ï¼ˆå¦‚ 3 å¤©ï¼‰è®“ç©å®¶ä½¿ç”¨å®Œç¥¨åˆ¸</p>
                        <ul style="color: #94a3b8; font-size: 12px; margin-top: 8px; padding-left: 16px;">
                            <li>âœ… å¹³è¡¡ç©å®¶é«”é©—èˆ‡æˆæœ¬æ§åˆ¶</li>
                            <li>âŒ å¢åŠ æ´»å‹•è¨­å®šè¤‡é›œåº¦</li>
                        </ul>
                    </div>
                </div>

                <div class="note warning" style="margin-top: 20px;">
                    <div class="note-title">ğŸ“… å¾… Review</div>
                    <p>æ­¤è­°é¡Œéœ€èˆ‡æŠ€è¡“é•·è¨è«–ç¢ºèªï¼Œæ¶‰åŠï¼š</p>
                    <ul style="margin-left: 16px; margin-top: 8px; color: #fef3c7;">
                        <li>ç”¢å“å®šç¾©ï¼šæ´»å‹•çµæŸçš„èªæ„æ˜¯ä»€éº¼ï¼Ÿ</li>
                        <li>è²¡å‹™è€ƒé‡ï¼šæ´»å‹•çµæŸå¾Œçš„æˆæœ¬å¦‚ä½•æ­¸å±¬ï¼Ÿ</li>
                        <li>æŠ€è¡“å¯¦ä½œï¼šExpiration Job æ˜¯å¦éœ€è¦æ„ŸçŸ¥æ´»å‹•ç‹€æ…‹ï¼Ÿ</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Q4 -->
        <div class="qa-card" style="border: 2px solid #10b981;">
            <div class="question" style="background: linear-gradient(135deg, #14532d 0%, #166534 100%);">
                <span class="q-badge" style="background: #10b981;">Q4</span>
                <span>Ticket éæœŸæ™‚å¦‚ä½•è™•ç†å·²ä½¿ç”¨çš„ Roundï¼Ÿ</span>
                <span style="margin-left: auto; background: #10b981; color: #fff; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">âœ… REVIEWED</span>
            </div>
            <div class="answer">
                <div class="answer-label">ğŸ’¡ çµè«–</div>
                
                <div class="solution recommended">
                    <div class="solution-header">
                        <span class="solution-title">æ­¤å•é¡Œå·²ä¸éœ€è¨è«–</span>
                        <span class="badge-recommended">RESOLVED</span>
                    </div>
                    <p>å› ç‚ºæˆæœ¬è¨ˆç®—æ–¹å¼ç‚º <strong>Tickets Ã— Max Payout</strong>ï¼Œä¸”æ¯æ¬¡ Spin å³æ™‚æ´¾ç™¼çé‡‘ï¼ŒéæœŸè™•ç†è®Šå¾—éå¸¸ç°¡å–®ã€‚</p>
                </div>
                
                <table style="margin-top: 16px;">
                    <tr><th>Ticket ç‹€æ…‹</th><th>éæœŸè™•ç†</th><th>ç©å®¶ç²å¾—</th></tr>
                    <tr><td><code>pending</code></td><td>ç›´æ¥æ¨™è¨˜ expired</td><td>$0</td></tr>
                    <tr><td><code>inuse</code></td><td>åœæ­¢æ–° Spinï¼Œä¿ç•™å·²æ´¾å½©</td><td>accumulated_payout (å·²å³æ™‚æ´¾ç™¼)</td></tr>
                    <tr><td><code>completed</code></td><td>ä¸å—å½±éŸ¿</td><td>total_payout</td></tr>
                </table>

                <div class="note" style="margin-top: 16px;">
                    <div class="note-title">âœ¨ é—œéµè¨­è¨ˆ</div>
                    <p>æ¯æ¬¡ Spin éƒ½å³æ™‚å¥—ç”¨ Cap ä¸¦æ´¾å½©çµ¦ç©å®¶ï¼Œ<strong>éæœŸæ™‚ç„¡éœ€ä»»ä½•é‡‘é¡èª¿æ•´</strong>ï¼Œåªéœ€åœæ­¢æ¥å—æ–°çš„ Spin å³å¯ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="main-footer">
        <p>FRB 2.0 Documentation | Last Updated: 2026-01-13</p>
    </footer>

    <script>
        // Tab switching logic
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active from all tabs
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active to clicked tab
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>
